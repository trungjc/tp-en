(()=>{"use strict";var t={n:e=>{var a=e&&e.__esModule?()=>e.default:()=>e;return t.d(a,{a}),a},d:(e,a)=>{for(var r in a)t.o(a,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:a[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};const e=jQuery;var a=t.n(e);const r=lodash;function o(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.markers={},this.categorySelector=a()("#rank-math-select-category"),this.mapWrapper=a()(".rank-math-local-map"),this.storeLocator=a()("#rank-math-local-store-locator"),this.directionsWrapper=a()(".rank-math-directions-wrapper"),this.address=a()("#rank-math-search-address"),this.currentLocation=a()("#rank-math-current-location"),this.initMap(),this.initStoreLocator(),this.categoryFilter(),this.detectLocation()}var e,n,i;return e=t,(n=[{key:"initMap",value:function(){var t=this;if(!this.mapWrapper.length)return!1;a()(".rank-math-local-map").each((function(e,o){var n=a()(o).data("map-options");if(!(0,r.isUndefined)(n)){var i="rank-math-local-map-"+e;a()(o).attr("id",i),a()(o).removeAttr("data-map-options"),t.initializeMap(i,n)}}))}},{key:"initializeMap",value:function(t,e){var a=this,o=new google.maps.LatLngBounds,n=e.locations,i=Object.keys(n).length>1,s={zoom:parseInt(e.zoom_level),zoomControl:e.allow_zoom,draggable:e.allow_dragging,mapTypeId:e.map_style};i||(s.center={lat:Number(n[Object.keys(n)[0]].lat),lng:Number(n[Object.keys(n)[0]].lng)});var l=new google.maps.Map(document.getElementById(t),s),c=new google.maps.InfoWindow;(0,r.forEach)(n,(function(t,r){var i=new google.maps.Marker({position:new google.maps.LatLng(t.lat,t.lng),map:l,type:t.terms});o.extend(i.position),n[r].content=t.content,e.show_infowindow&&google.maps.event.addListener(i,"click",function(t,e){return function(){c.setContent(n[e].content),c.setOptions({maxWidth:200}),c.open(l,t)}}(i,r)),a.markers[r]=i})),i&&l.fitBounds(o),e.show_clustering&&this.markerClusterer(l),this.getRoute(l)}},{key:"markerClusterer",value:function(t){new MarkerClusterer(t,this.markers,{imagePath:"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m"})}},{key:"categoryFilter",value:function(){var t=this;if(!this.categorySelector.length)return!1;this.categorySelector.on("change",(function(){var e=parseInt(t.categorySelector.val());(0,r.forEach)(t.markers,(function(o,n){isNaN(e)?t.markers[n].setVisible(!0):(0,r.isUndefined)(o.type)||-1===a().inArray(e,o.type)?t.markers[n].setVisible(!1):t.markers[n].setVisible(!0)}))}))}},{key:"initStoreLocator",value:function(){if(this.storeLocator.length){var t=new google.maps.Geocoder,e=1;a()("#rank-math-local-store-locator").on("submit",(function(r){var o=this;if(1===e){r.preventDefault();var n=a()(this).find("#rank-math-search-address").val();return t.geocode({address:n},(function(t,r){"OK"===r?(a()(o).find("#rank-math-lat").val(t[0].geometry.location.lat()),a()(o).find("#rank-math-lng").val(t[0].geometry.location.lng()),e++,a()(o).trigger("submit")):console.error("Geocode was not successful for the following reason: "+r)})),!1}}))}}},{key:"detectLocation",value:function(){var t=this;this.currentLocation.length&&navigator.geolocation&&this.currentLocation.on("click",(function(e){return e.preventDefault(),navigator.geolocation.getCurrentPosition((function(e){var a={lat:parseFloat(e.coords.latitude),lng:parseFloat(e.coords.longitude)};(new google.maps.Geocoder).geocode({location:a},(function(e,a){"OK"===a&&t.address.val(e[0].formatted_address)}))})),!1}))}},{key:"getRoute",value:function(t){var e=this;if(this.directionsWrapper.length){this.directionsWrapper.find(".rank-math-show-route").on("click",(function(t){t.preventDefault();var e=a()(this).data("toggle-text");return a()(this).data("toggle-text",a()(this).text()).text(e),a()(this).parent().toggleClass("show"),a()(this).parent().find(".rank-math-directions").html()||a()(this).parent().find("form").trigger("submit"),!1}));var r=a()(".rank-math-directions-wrapper").find("form"),o=new google.maps.DirectionsRenderer,n=new google.maps.DirectionsService;o.setMap(t),r.on("submit",(function(t){t.preventDefault();var i=a()(t.target).parent().next(".rank-math-directions"),s={origin:r.find("#rank-math-origin").val(),destination:new google.maps.LatLng(a()(t.target).find("#rank-math-lat").val(),a()(t.target).find("#rank-math-lng").val()),travelMode:"DRIVING",unitSystem:google.maps.UnitSystem.IMPERIAL};return n.route(s,(function(t,a){"OK"===a&&(o.setDirections(t),i.html(e.getDirectionsData(t)))})),!1}))}}},{key:"getDirectionsData",value:function(t){var e="",a=t.routes[0].legs[0];return e+="<h4>"+a.start_address+"</h4>",e+="<ul>",(0,r.forEach)(a.steps,(function(t){e+='<li class="'+t.maneuver+'">'+t.instructions+"</li>"})),e+="</ul>",e+="<h4>"+a.end_address+"</h4>",e+="<h5><em>"+t.routes[0].copyrights+"</em><h5>"}}])&&o(e.prototype,n),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();google.maps.event.addDomListener(window,"load",new n)})();